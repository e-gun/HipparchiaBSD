
[log in as huser]

su root
	root# pkg install nano nginx python35 rsync sudo postgresql95-server curl git-lite
	root# visudo [and add huser]
	root# printf "\033[31mHipparchia Server\033[0m" > /etc/issue
	root# printf "\n\n\t\tWelcome to \033[31mHipparchia Server\033[0m\n\n\n" > /etc/motd
	root# exit

mkdir venv logs run
mkdir ~/venv/HipparchiaData ~/venv/HipparchiaServer ~/venv/HipparchiaSQLoader ~/venv/HipparchiaBuilder ~/venv/HipparchiaBSD
cd ~/venv/HipparchiaServer/ && git init && git pull https://github.com/e-gun/HipparchiaServer.git
cd ~/venv/HipparchiaBuilder/ && git init && git pull https://github.com/e-gun/HipparchiaBuilder.git
cd ~/venv/HipparchiaSQLoader/ && git init && git pull https://github.com/e-gun/HipparchiaSQLoader.git
cd ~/venv/HipparchiaBSD/ && git init && git pull https://github.com/e-gun/HipparchiaBSD.git

sudo su root
	root# cat ~huser/venv/HipparchiaBSD/rc_conf.txt >> /etc/rc.conf
	root# /usr/local/etc/rc.d/postgresql initdb
	root# nano /usr/local/pgsql/data/postgresql.conf [shared_buffers = 256MB]
	root# exit

sudo su pgsql
	pgsql$ cd ~ && /usr/local/bin/pg_ctl -D /usr/local/pgsql/data -l logfile start
	pgsql$ createdb hipparchiaDB && psql hipparchiaDB
		[insert sql via generate_hipparchia_dbs.sql]
		[need two roles (hippa_wr & hippa_rd) and authors and works tables]
	pgsql$ exit

cp ~/venv/HipparchiaBSD/uwsgi.ini ~/uwsgi.ini
cp ~/venv/HipparchiaBSD/selfupdate.sh ~/selfupdate.sh
cp ~/venv/HipparchiaBSD/cshrc.txt ~/.cshrc
source ~/.cshrc 
sudo cp ~/venv/HipparchiaBSD/ngingx_conf.txt /usr/local/etc/nginx/nginx.conf
sudo cp ~/venv/HipparchiaBSD/circusd.ini /usr/local/etc/circusd.ini
sudo cp ~/venv/HipparchiaBSD/circusd /usr/local/etc/rc.d/circusd
sudo cp ~/venv/HipparchiaBSD/pf_conf.txt /etc/pf.conf


/usr/local/bin/pyvenv-3.5 ~/venv/
source ~/venv/bin/activate.csh
pip install bs4 circus flask psycopg2 uWSGI

ln -s venv/bin/circusctl ~/circusctl
ln -s /usr/local/etc/circusd.ini ~/the_circusd.ini
sudo cp ~/venv/bin/circusd /usr/local/bin/circusd
nano ~/venv/HipparchiaServer/config.py
nano ~/venv/HipparchiaBuilder/config.ini
cp ~/venv/HipparchiaBuilder/config.ini ~/venv/HipparchiaSQLoader/config.ini

[install jquery and fonts in ~/venv/HipparchiaServer/server/static/]
[copy the relevant data into HipparchiaData]
	e.g. 
	scp -rp greek latin lexica huser@192.168.1.16:/usr/home/huser/venv/HipparchiaData
	- OR - 
	scp -rp sqldumps huser@192.168.1.16:/usr/home/huser/venv/HipparchiaData
[load/build]
	[make sure buildauthors = True; buildlex = True; buildgram = True]
	cd ~/venv/HipparchiaBuilder && python build_it_all.py
	— OR —
	cd ~/venv/HipparchiaSQLoader && python reloadhipparchiaDBs.py
[reboot]


===

[venv] huser@hipparchia-bsd:~ % pkg info
ca_root_nss-3.27               Root certificate bundle from the Mozilla Project
curl-7.50.3                    Non-interactive tool to get files from FTP, GOPHER, HTTP(S) servers
expat-2.2.0                    XML 1.0 parser written in C
gettext-runtime-0.19.8.1       GNU gettext runtime libraries and programs
git-lite-2.9.2_2               Distributed source code management tool (lite package)
indexinfo-0.2.5                Utility to regenerate the GNU info page index
libffi-3.2.1                   Foreign Function Interface
libxml2-2.9.4                  XML parser library for GNOME
nano-2.7.0                     Nano's ANOther editor, an enhanced free Pico clone
nginx-1.10.1_2,2               Robust and small WWW server
pcre-8.39                      Perl Compatible Regular Expressions library
perl5-5.20.3_15                Practical Extraction and Report Language
pkg-1.8.7_3                    Package manager
postgresql95-client-9.5.4_1    PostgreSQL database (client)
postgresql95-server-9.5.4_1    The most advanced open-source database available anywhere
python35-3.5.2                 Interpreted object-oriented programming language
readline-6.3.8                 Library for editing command lines as they are typed
rsync-3.1.2_5                  Network file distribution/synchronization utility
sudo-1.8.18                    Allow others to run commands as root

[venv] huser@hipparchia-bsd:~ % pip list
beautifulsoup4 (4.5.1)
bs4 (0.0.1)
circus (0.14.0)
click (6.6)
Flask (0.11.1)
Flask-WTF (0.13.1)
iowait (0.2)
itsdangerous (0.24)
Jinja2 (2.8)
MarkupSafe (0.23)
pip (8.1.2)
psutil (4.3.1)
psycopg2 (2.6.2)
pyzmq (16.0.0)
setuptools (20.10.1)
tornado (4.4.2)
uWSGI (2.0.14)
Werkzeug (0.11.11)
WTForms (2.1)


Build took 134.39 minutes
[venv] huser@hipparchia-bsd:~/venv/HipparchiaBuilder % df -h
Filesystem            Size    Used   Avail Capacity  Mounted on
zroot/ROOT/default    3.7G    3.4G    269M    93%    /
devfs                 1.0K    1.0K      0B   100%    /dev
zroot/tmp             269M    112K    269M     0%    /tmp
zroot/usr/home        902M    633M    269M    70%    /usr/home
zroot/usr/ports       269M     96K    269M     0%    /usr/ports
zroot/usr/src         269M     96K    269M     0%    /usr/src
zroot/var/audit       269M     96K    269M     0%    /var/audit
zroot/var/crash       269M     96K    269M     0%    /var/crash
zroot/var/log         269M    144K    269M     0%    /var/log
zroot/var/mail        269M     96K    269M     0%    /var/mail
zroot/var/tmp         269M     96K    269M     0%    /var/tmp
zroot                 269M     96K    269M     0%    /zroot

